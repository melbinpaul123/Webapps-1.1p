#include <iostream>
#include <fstream>
#include <string>
#include <vector>

using namespace std;

struct knight_data
{
    string name;
    double weight;
    string birth_month;
    int age;
};

string read_string(const string &prompt)
{
    cout << prompt;
    string input;
    cin >> input;
    return input;
}

int read_integer(const string &prompt)
{
    cout << prompt;
    int input;
    cin >> input;
    return input;
}

double read_double(const string &prompt)
{
    cout << prompt;
    double input;
    cin >> input;
    return input;
}

knight_data read_knight()
{
    knight_data result;
    result.name = read_string("Enter the name of the knight: ");
    result.age = read_integer("Enter the age of the knight: ");
    result.birth_month = read_string("Enter the birth month of the knight: ");
    result.weight = read_double("Enter the weight of the knight: ");
    return result;
}

void write_knight(const knight_data &knight, ofstream &htmlFile)
{
    htmlFile << "<p>Name: " << knight.name << "</p>" << endl;
    htmlFile << "<p>Age: " << knight.age << "</p>" << endl;
    htmlFile << "<p>Birth Month: " << knight.birth_month << "</p>" << endl;
    htmlFile << "<p>Weight: " << knight.weight << "</p>" << endl;
}

void search_knight(const vector<knight_data> &knights, const string &search_name)
{
    cout << "Searching for knight: " << search_name << endl;
    bool found = false;

    ofstream htmlFile("search_results.html"); // Open an HTML file for writing

    if (htmlFile.is_open())
    {
        htmlFile << "<html><body>" << endl;
        for (const knight_data &knight : knights)
        {
            if (knight.name == search_name)
            {
                write_knight(knight, htmlFile);
                found = true;
                break; // No need to continue searching
            }
        }
        htmlFile << "</body></html>" << endl;
        htmlFile.close();
    }
    else
    {
        cout << "Error: Unable to create HTML file." << endl;
    }

    if (!found)
    {
        cout << "Knight with name '" << search_name << "' not found." << endl;
    }
}

int main()
{
    vector<knight_data> knights;

    while (true)
    {
        cout << "1. Add a knight" << endl;
        cout << "2. Display all knights" << endl;
        cout << "3. Search for a knight and save as HTML" << endl;
        cout << "4. Quit" << endl;

        int choice;
        cin >> choice;

        switch (choice)
        {
        case 1:
            knights.push_back(read_knight());
            break;
        case 2:
            cout << "Knights:" << endl;
            for (const knight_data &knight : knights)
            {
                write_knight(knight, cout);
            }
            break;
        case 3:
            {
                string search_name;
                cin.ignore();  // Clear newline left in the input buffer
                search_name = read_string("Enter the name of the knight to search: ");
                search_knight(knights, search_name);
                cout << "Search results saved to 'search_results.html'." << endl;
            }
            break;
        case 4:
            return 0;
        default:
            cout << "Invalid choice. Please try again." << endl;
            break;
        }
    }

    return 0;
}
